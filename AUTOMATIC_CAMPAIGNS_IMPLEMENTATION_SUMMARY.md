# Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… ĞºĞ°Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¹ - Ğ˜Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ğ°Ñ ÑĞ²Ğ¾Ğ´ĞºĞ°

## âœ… ĞŸĞ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸

### 1. Ğ Ğ°ÑÑ‡Ñ‘Ñ‚ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ ĞµĞ´Ğ¸Ğ½Ğ¸Ñ†Ñ‹ Ğ°ÑƒĞ´Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¸ (unitAudienceCost)

**Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ°:**
```typescript
unitAudienceCost = avgBudget / avgAudience

Ğ³Ğ´Ğµ:
  avgBudget = (minBudget + maxBudget) / 2
  avgAudience = (minAudience + maxAudience) / 2
```

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€:**
```
ĞšĞ°Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ñ: Ğ±ÑĞ´Ğ¶ĞµÑ‚ 100-200, Ğ°ÑƒĞ´Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ 1000-2000
â†’ avgBudget = 150
â†’ avgAudience = 1500
â†’ unitAudienceCost = 150 / 1500 = 0.1 (10 Ñ†ĞµĞ½Ñ‚Ğ¾Ğ² Ğ·Ğ° Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑ‡Ğ¸ĞºĞ°)
```

**Ğ“Ğ´Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ:**
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğ¸ ĞºĞ°Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸
- Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ÑÑ Ğ² `metadata.automaticSettings.unitAudienceCost`
- Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ğ¸Ğ½Ñ„Ğ»ÑĞµĞ½ÑĞµÑ€Ğ¾Ğ²

---

### 2. ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ ÑĞ¾Ğ¾Ñ‚Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ñ Ñ†ĞµĞ½Ğ°/Ğ°ÑƒĞ´Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ

**ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼:**

```typescript
// Ğ”Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ¸Ğ½Ñ„Ğ»ÑĞµĞ½ÑĞµÑ€Ğ°
influencerPricePerAudience = influencerPrice / influencerAudience

// ĞÑ‚ĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚ Ğ¸Ğ´ĞµĞ°Ğ»Ğ°
deviationFromIdeal = |influencerPricePerAudience - unitAudienceCost|

// Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°: Ğ¾Ñ‚ Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¾Ñ‚ĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¸Ñ Ğº Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¼Ñƒ
sorted by deviationFromIdeal (ASC)
```

**Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:**

```
unitAudienceCost = 0.1

Ğ˜Ğ½Ñ„Ğ»ÑĞµĞ½ÑĞµÑ€Ñ‹:
- Ğ: 0.10 â†’ deviation = 0.00 âœ… ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ 1
- Ğ‘: 0.09 â†’ deviation = 0.01 âœ… ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ 2
- Ğ’: 0.12 â†’ deviation = 0.02 âœ… ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ 3
- Ğ“: 0.05 â†’ deviation = 0.05 âš ï¸  ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ 4
- Ğ”: 0.20 â†’ deviation = 0.10 âŒ ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ 5

ĞŸÑ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑÑ‚ÑÑ Ğ² Ğ¿Ğ¾Ñ€ÑĞ´ĞºĞµ: Ğ â†’ Ğ‘ â†’ Ğ’ â†’ Ğ“ â†’ Ğ”
```

---

### 3. Ğ”ĞµĞ´ÑƒĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ğ¸Ğ½Ñ„Ğ»ÑĞµĞ½ÑĞµÑ€Ğ¾Ğ²

**ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ¾:** ĞĞ´Ğ¸Ğ½ userId = Ğ¾Ğ´Ğ½Ğ¾ ÑƒÑ‡Ğ°ÑÑ‚Ğ¸Ğµ Ğ² ĞºĞ°Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸

**ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼:**
1. Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞµĞº Ğ¿Ğ¾ userId
2. Ğ”Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ userId - Ñ€Ğ°ÑÑ‡Ñ‘Ñ‚ ÑÑ€ĞµĞ´Ğ½ĞµĞ¹ Ñ†ĞµĞ½Ñ‹ Ğ²ÑĞµÑ… ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞµĞº
3. Ğ’Ñ‹Ğ±Ğ¾Ñ€ ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ñ Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ñ†ĞµĞ½Ğ¾Ğ¹
4. ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½Ğ¸Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ Ğ´ĞµĞ´ÑƒĞ¿Ğ»Ğ¸Ñ†Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¼ ÑĞ¿Ğ¸ÑĞºĞ¾Ğ¼

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€:**

```typescript
Ğ˜Ğ½Ñ„Ğ»ÑĞµĞ½ÑĞµÑ€ Ivan (userId: 123) Ğ¸Ğ¼ĞµĞµÑ‚ 2 ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸:

CardA: Instagram, followers=50k, pricing={post:500, story:300}
       â†’ avgPrice = 400

CardB: Instagram, followers=50k, pricing={post:400, story:250}
       â†’ avgPrice = 325 âœ… Ğ’Ñ‹Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ÑÑ ÑÑ‚Ğ°!

Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚: Ğ˜Ğ²Ğ°Ğ½Ñƒ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ÑÑ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ 1 Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ CardB
```

**ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:**
- Ğ¡Ğ¿Ñ€Ğ°Ğ²ĞµĞ´Ğ»Ğ¸Ğ²Ğ¾ÑÑ‚ÑŒ (Ğ¾Ğ´Ğ¸Ğ½ Ñ‡ĞµĞ»Ğ¾Ğ²ĞµĞº = Ğ¾Ğ´Ğ¸Ğ½ ÑˆĞ°Ğ½Ñ)
- Ğ­Ñ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ğ¾Ğ²ĞµÑ€Ğ±ÑƒĞºĞ¸Ğ½Ğ³ (Ğ²ÑĞµ ÑĞ»Ğ¾Ñ‚Ñ‹ Ğ½Ğ° ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ»ÑĞ´ĞµĞ¹)
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ±ÑĞ´Ğ¶ĞµÑ‚Ğ°

**ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½ĞµĞµ:** Ğ¡Ğ¼. `AUTOMATIC_CAMPAIGNS_DEDUPLICATION.md`

---

### 4. ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ñ€Ñ‹Ğ½Ğ¾Ñ‡Ğ½Ğ°Ñ Ğ¾Ñ†ĞµĞ½ĞºĞ° Ğ±ÑĞ´Ğ¶ĞµÑ‚Ğ°

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ:** `calculateMarketBudgetRecommendation()`

**Ğ’Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹:**
- minAudience, maxAudience
- targetCount (ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¸Ğ½Ñ„Ğ»ÑĞµĞ½ÑĞµÑ€Ğ¾Ğ²)
- platforms (ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼)
- contentTypes (Ñ‚Ğ¸Ğ¿Ñ‹ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ°)

**ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼:**
1. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ğ¸Ğ½Ñ„Ğ»ÑĞµĞ½ÑĞµÑ€Ğ¾Ğ² Ğ¿Ğ¾ ĞºÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸ÑĞ¼
2. Ğ”Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ pricePerFollower
3. ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ¼ĞµĞ´Ğ¸Ğ°Ğ½Ğ½Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ pricePerFollower
4. Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ±ÑĞ´Ğ¶ĞµÑ‚:
   ```
   recommendedBudget = avgAudience * medianPricePerFollower
   min = recommendedBudget * 0.8
   max = recommendedBudget * 1.2
   ```

**Fallback:** Ğ•ÑĞ»Ğ¸ Ğ½ĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… â†’ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ ÑÑ€ĞµĞ´Ğ½Ğ¸Ğ¹ Ñ€Ñ‹Ğ½Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ 0.05 (5 Ñ†ĞµĞ½Ñ‚Ğ¾Ğ² Ğ·Ğ° Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑ‡Ğ¸ĞºĞ°)

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€:**
```
Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ: 10k-20k Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑ‡Ğ¸ĞºĞ¾Ğ², 100 Ğ¸Ğ½Ñ„Ğ»ÑĞµĞ½ÑĞµÑ€Ğ¾Ğ², Instagram, Post+Story

ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ€Ñ‹Ğ½ĞºĞ°:
- ĞĞ°Ğ¹Ğ´ĞµĞ½Ğ¾ 50 Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ñ… ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞµĞº
- ĞœĞµĞ´Ğ¸Ğ°Ğ½Ğ½Ğ°Ñ Ñ†ĞµĞ½Ğ° Ğ·Ğ° Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑ‡Ğ¸ĞºĞ°: 0.08

Ğ Ğ°ÑÑ‡Ñ‘Ñ‚:
- avgAudience = 15000
- recommendedBudget = 15000 * 0.08 = 1200

Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚: {min: 960, max: 1440, currency: 'USD'}
```

---

### 5. ĞœĞµÑ…Ğ°Ğ½Ğ¸Ğ·Ğ¼ Ğ¾Ğ²ĞµÑ€Ğ±ÑƒĞºĞ¸Ğ½Ğ³Ğ°

**ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹:**
- `targetInfluencerCount` (N) - Ñ†ĞµĞ»ĞµĞ²Ğ¾Ğµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾
- `overbookingPercentage` (X%) - Ğ¿Ñ€Ğ¾Ñ†ĞµĞ½Ñ‚ Ğ¾Ğ²ĞµÑ€Ğ±ÑƒĞºĞ¸Ğ½Ğ³Ğ°

**Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ°:**
```typescript
maxOffersToSend = Math.ceil(N * (1 + X / 100))
```

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€:**
```
N = 100, X = 25%
â†’ maxOffersToSend = 100 * 1.25 = 125

Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ 125 Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹
ĞĞ¾ Ğ½Ğ°Ğ±Ğ¾Ñ€ Ğ·Ğ°ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ¿Ğ¾ÑĞ»Ğµ Ğ¿Ñ€Ğ¸Ğ½ÑÑ‚Ğ¸Ñ 100
```

**ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ğ¸ Ñ†ĞµĞ»Ğ¸:**
1. Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ ĞºĞ°Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸ â†’ `in_progress`
2. Ğ’ÑĞµ pending Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ â†’ `expired`
3. ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ¸ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹

**Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:** Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€ Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… `check_recruitment_target()`

---

### 6. ĞœĞµÑ…Ğ°Ğ½Ğ¸Ğ·Ğ¼ Ğ´Ğ¾Ğ±Ğ¾Ñ€Ğ°

**Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€:** Ğ’Ñ‹Ğ±Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸Ğ½Ñ„Ğ»ÑĞµĞ½ÑĞµÑ€Ğ° (ÑÑ‚Ğ°Ñ‚ÑƒÑ offer â†’ cancelled/withdrawn/terminated)

**ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ñ‹:**

**ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ 1:** Ğ ĞµĞ°ĞºÑ‚Ğ¸Ğ²Ğ°Ñ†Ğ¸Ñ expired Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹
```sql
SELECT * FROM collaboration_offers
WHERE campaign_id = ?
  AND status = 'expired'
  AND metadata->>'expirationReason' = 'recruitment_completed'
ORDER BY metadata->>'score' DESC
LIMIT 1
```

**ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ 2:** ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº
```typescript
// ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ¸Ğ½Ñ„Ğ»ÑĞµĞ½ÑĞµÑ€Ğ¾Ğ², Ğ¸ÑĞºĞ»ÑÑ‡Ğ°Ñ ÑƒĞ¶Ğµ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ğ²ÑˆĞ¸Ñ… Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ
const newInfluencers = await findAndScoreInfluencers(campaign)
  .filter(inf => !existingOfferInfluencerIds.includes(inf.userId));

// ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ»ÑƒÑ‡ÑˆĞµĞ¼Ñƒ
await createOffer(campaign, newInfluencers[0]);
```

**ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñ:**
- `autoReplacement` Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ±Ñ‹Ñ‚ÑŒ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½
- Ğ›Ğ¸Ğ¼Ğ¸Ñ‚ Ğ·Ğ°Ğ¼ĞµĞ½ Ğ½Ğ° Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ¸Ğ½Ñ„Ğ»ÑĞµĞ½ÑĞµÑ€Ğ°: `maxReplacements`

---

### 7. Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ Ğ¾Ñ‚ĞºĞ»Ğ¸ĞºĞ¾Ğ² ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ĞµĞ»Ñ

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ:** `checkCampaignOwnership(userId, campaign)`

**Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚:** `true` ĞµÑĞ»Ğ¸ userId === campaign.advertiserId

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² UI:**
```typescript
if (automaticCampaignService.checkCampaignOwnership(currentUser.id, campaign)) {
  // ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ "Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ"
} else {
  // ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ "ĞÑ‚ĞºĞ»Ğ¸ĞºĞ½ÑƒÑ‚ÑŒÑÑ"
}
```

---

### 8. Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ Ğ¿Ğ¾Ğ·Ğ´Ğ½Ğ¸Ñ… Ğ¿Ñ€Ğ¸Ğ½ÑÑ‚Ğ¸Ğ¹

**ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°:** Ğ’ Ğ¼ĞµÑ‚Ğ¾Ğ´Ğµ `handleOfferResponse()`

```typescript
// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ° "Ğ¿Ğ¾Ğ·Ğ´Ğ½ĞµĞµ Ğ¿Ñ€Ğ¸Ğ½ÑÑ‚Ğ¸Ğµ"
if (response === 'accepted' && campaign.status !== 'active') {
  // ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¾Ñ‚ĞºĞ°Ğ·
  await updateOffer({
    status: 'rejected',
    metadata: {
      autoRejected: true,
      rejectionReason: 'ĞĞ°Ğ±Ğ¾Ñ€ Ğ·Ğ°Ğ²ĞµÑ€ÑˆÑ‘Ğ½, Ğ²ÑĞµ Ğ¼ĞµÑÑ‚Ğ° Ğ·Ğ°Ğ½ÑÑ‚Ñ‹'
    }
  });

  // ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ
  return;
}
```

**Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹:**
1. ĞšĞ°Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ñ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ³Ğ»Ğ° 100 Ğ¿Ñ€Ğ¸Ğ½ÑÑ‚Ğ¸Ğ¹ â†’ ÑÑ‚Ğ°Ñ‚ÑƒÑ `in_progress`
2. Ğ˜Ğ½Ñ„Ğ»ÑĞµĞ½ÑĞµÑ€ Ğ¿Ñ‹Ñ‚Ğ°ĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¸Ğ½ÑÑ‚ÑŒ expired Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ
3. Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¾Ñ‚ĞºĞ»Ğ¾Ğ½ÑĞµÑ‚ Ñ Ğ¾Ğ±ÑŠÑÑĞ½ĞµĞ½Ğ¸ĞµĞ¼

---

### 9. Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹ Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

**Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€ 1:** `check_recruitment_target()`
- Ğ¡Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚: ĞŸÑ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ° offer Ğ½Ğ° `accepted`
- Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ:
  1. ĞŸĞ¾Ğ´ÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ¸Ğ½ÑÑ‚Ñ‹Ğµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
  2. Ğ•ÑĞ»Ğ¸ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ³Ğ½ÑƒÑ‚Ğ° Ñ†ĞµĞ»ÑŒ â†’ ĞºĞ°Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ñ Ğ² `in_progress`
  3. Pending Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ â†’ `expired`

**Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€ 2:** `handle_influencer_dropout()`
- Ğ¡Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚: ĞŸÑ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ° offer Ğ½Ğ° `cancelled`/`withdrawn`/`terminated`
- Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ:
  1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ autoReplacement
  2. ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ pg_notify Ğ´Ğ»Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ² Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¸

---

## ğŸ“Š ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ñ†Ğ¸ĞºĞ» Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ğ°Ğ²Ñ‚Ğ¾ĞºĞ°Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Ğ¡ĞĞ—Ğ”ĞĞĞ˜Ğ• ĞšĞĞœĞŸĞĞĞ˜Ğ˜                                        â”‚
â”‚     - Ğ Ğ°ÑÑ‡Ñ‘Ñ‚ unitAudienceCost                                â”‚
â”‚     - Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞº Ğ² metadata                         â”‚
â”‚     - Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: active                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. ĞŸĞĞ˜Ğ¡Ğš Ğ˜ ĞĞ¦Ğ•ĞĞšĞ Ğ˜ĞĞ¤Ğ›Ğ®Ğ•ĞĞ¡Ğ•Ğ ĞĞ’                              â”‚
â”‚     - ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞµĞº Ğ¿Ğ¾ ĞºÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸ÑĞ¼                        â”‚
â”‚     - Ğ”ĞµĞ´ÑƒĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ userId (Ğ¼Ğ¸Ğ½. Ñ†ĞµĞ½Ğ°)                     â”‚
â”‚     - Ğ Ğ°ÑÑ‡Ñ‘Ñ‚ pricePerAudience Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾                    â”‚
â”‚     - Ğ Ğ°ÑÑ‡Ñ‘Ñ‚ deviationFromIdeal                              â”‚
â”‚     - Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾ deviation (ASC)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. ĞĞ¢ĞŸĞ ĞĞ’ĞšĞ ĞŸĞ Ğ•Ğ”Ğ›ĞĞ–Ğ•ĞĞ˜Ğ™                                     â”‚
â”‚     - maxOffers = N * (1 + X%)                               â”‚
â”‚     - ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ñ‚Ğ¾Ğ¿-Ğ¸Ğ½Ñ„Ğ»ÑĞµĞ½ÑĞµÑ€Ğ°Ğ¼ Ğ¿Ğ¾ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ñƒ                â”‚
â”‚     - Ğ’ÑĞµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ² ÑÑ‚Ğ°Ñ‚ÑƒÑĞµ: pending                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. ĞŸĞ Ğ˜ĞĞœ ĞŸĞ Ğ•Ğ”Ğ›ĞĞ–Ğ•ĞĞ˜Ğ™                                        â”‚
â”‚     - Ğ˜Ğ½Ñ„Ğ»ÑĞµĞ½ÑĞµÑ€Ñ‹ Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ÑÑ‚/Ğ¾Ñ‚ĞºĞ»Ğ¾Ğ½ÑÑÑ‚                        â”‚
â”‚     - Ğ¡Ñ‡Ñ‘Ñ‚Ñ‡Ğ¸Ğº acceptedCount++                                â”‚
â”‚     - ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°: acceptedCount >= N?                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                           â”‚
     Ğ”Ğ (Ñ†ĞµĞ»ÑŒ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ³Ğ½ÑƒÑ‚Ğ°)        ĞĞ•Ğ¢ (Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°ĞµĞ¼)
            â”‚                           â”‚
            â†“                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ˜Ğ• ĞĞĞ‘ĞĞ Ğ     â”‚   â”‚  ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ        â”‚
â”‚     - Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: in_progress â”‚   â”‚  Ğ¾Ñ‚ĞºĞ»Ğ¸ĞºĞ¾Ğ²        â”‚
â”‚     - Pending â†’ expired   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚     - ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾Ğ¸ÑĞºĞ°    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. Ğ ĞĞ‘ĞĞ¢Ğ Ğ¡ ĞšĞĞœĞŸĞĞĞ˜Ğ•Ğ™                                       â”‚
â”‚     - Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ĞµĞ¹                                 â”‚
â”‚     - ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¾Ğ²                                  â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚     â”‚ Ğ•ÑĞ»Ğ¸ ĞºÑ‚Ğ¾-Ñ‚Ğ¾ Ğ²Ñ‹Ğ±Ñ‹Ğ»:                 â”‚                   â”‚
â”‚     â”‚  â†’ ĞœĞµÑ…Ğ°Ğ½Ğ¸Ğ·Ğ¼ Ğ´Ğ¾Ğ±Ğ¾Ñ€Ğ°                 â”‚                   â”‚
â”‚     â”‚     1. Ğ ĞµĞ°ĞºÑ‚Ğ¸Ğ²Ğ°Ñ†Ğ¸Ñ expired         â”‚                   â”‚
â”‚     â”‚     2. ĞŸĞ¾Ğ¸ÑĞº Ğ½Ğ¾Ğ²Ñ‹Ñ…                 â”‚                   â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  7. Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ˜Ğ• ĞšĞĞœĞŸĞĞĞ˜Ğ˜                                      â”‚
â”‚     - Ğ’ÑĞµ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ñ‹                               â”‚
â”‚     - Ğ’ÑĞµ Ğ²Ñ‹Ğ¿Ğ»Ğ°Ñ‚Ñ‹ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²ĞµĞ´ĞµĞ½Ñ‹                                â”‚
â”‚     - Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: completed                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ°: `collaboration_offers`

```sql
CREATE TABLE collaboration_offers (
  id UUID PRIMARY KEY,
  campaign_id UUID REFERENCES campaigns(campaign_id),
  influencer_id UUID REFERENCES user_profiles(user_id),
  advertiser_id UUID REFERENCES user_profiles(user_id),
  influencer_card_id UUID,

  details JSONB,  -- title, description, pricing, deliverables
  status TEXT,    -- pending, accepted, rejected, expired, cancelled
  timeline JSONB,
  metadata JSONB, -- score, pricePerAudience, deviationFromIdeal, etc.

  created_at TIMESTAMPTZ,
  updated_at TIMESTAMPTZ
);
```

### Metadata ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°

```typescript
metadata: {
  isAutomatic: true,
  campaignId: string,
  score: number,
  pricePerAudience: number,
  deviationFromIdeal: number,
  unitAudienceCost: number,
  sentAt: ISO timestamp,

  // Ğ”Ğ»Ñ expired
  expirationReason?: 'recruitment_completed',

  // Ğ”Ğ»Ñ reactivated
  reactivated?: boolean,
  reactivatedAt?: ISO timestamp,

  // Ğ”Ğ»Ñ rejected
  autoRejected?: boolean,
  rejectionReason?: string
}
```

---

## ğŸ¯ ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸

### ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ ĞºĞ°Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸

```typescript
campaign.metrics = {
  applicants: number,      // ĞĞµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ´Ğ»Ñ Ğ°Ğ²Ñ‚Ğ¾
  accepted: number,        // ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¿Ñ€Ğ¸Ğ½ÑÑ‚Ñ‹Ñ…
  impressions: number,
  engagement: number
}
```

### ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸ĞºĞ¸

```typescript
campaign.metadata.automaticSettings = {
  targetInfluencerCount: number,    // N
  overbookingPercentage: number,    // X%
  unitAudienceCost: number,         // Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ğ½Ğ½Ñ‹Ğ¹ ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚

  scoringWeights: {
    followers: number,
    engagement: number,
    relevance: number,
    responseTime: number
  },

  autoReplacement: boolean,
  maxReplacements: number,

  batchSize: number,
  batchDelay: number
}
```

---

## ğŸ”§ ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ API

### Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ°Ğ²Ñ‚Ğ¾ĞºĞ°Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸

```typescript
const campaign = await automaticCampaignService.createCampaign({
  advertiserId: currentUser.id,
  title: 'ĞŸÑ€Ğ¾Ğ´Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ°',
  description: 'Ğ˜Ñ‰ĞµĞ¼ Ğ¼Ğ¸ĞºÑ€Ğ¾-Ğ¸Ğ½Ñ„Ğ»ÑĞµĞ½ÑĞµÑ€Ğ¾Ğ²',
  brand: 'MyBrand',

  budget: {
    min: 100,
    max: 200,
    currency: 'USD'
  },

  preferences: {
    platforms: ['instagram'],
    contentTypes: ['post', 'story'],
    audienceSize: { min: 10000, max: 50000 },
    demographics: {
      ageRange: [18, 35],
      genders: ['all'],
      countries: ['US', 'CA']
    }
  },

  timeline: {
    startDate: '2024-12-01',
    endDate: '2024-12-31'
  },

  metadata: {
    automaticSettings: {
      targetInfluencerCount: 100,
      overbookingPercentage: 25,
      batchSize: 10,
      batchDelay: 5,
      scoringWeights: {
        followers: 25,
        engagement: 25,
        relevance: 25,
        responseTime: 25
      },
      autoReplacement: true,
      maxReplacements: 3
    }
  }
});
```

### ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ñ€Ñ‹Ğ½Ğ¾Ñ‡Ğ½Ğ¾Ğ¹ Ğ¾Ñ†ĞµĞ½ĞºĞ¸

```typescript
const recommendation = await automaticCampaignService
  .calculateMarketBudgetRecommendation(
    10000,  // minAudience
    50000,  // maxAudience
    100,    // targetCount
    ['instagram'],
    ['post', 'story']
  );

// recommendation = { min: 8000, max: 12000, currency: 'USD' }
```

### ĞŸÑ€Ğ¸Ğ½ÑÑ‚Ğ¸Ğµ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ

```typescript
await automaticCampaignService.handleOfferResponse(
  offerId,
  'accepted',
  currentUser.id
);
```

### ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ²Ñ‹Ğ±Ñ‹Ğ²Ğ°Ğ½Ğ¸Ñ

```typescript
await automaticCampaignService.handleInfluencerDropout(
  campaignId,
  influencerId
);
```

---

## âœ… Ğ˜Ñ‚Ğ¾Ğ³Ğ¸ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

### Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ

- âœ… Ğ Ğ°ÑÑ‡Ñ‘Ñ‚ unitAudienceCost
- âœ… ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ ÑĞ¾Ğ¾Ñ‚Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ñ Ñ†ĞµĞ½Ğ°/Ğ°ÑƒĞ´Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ
- âœ… Ğ”ĞµĞ´ÑƒĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ğ¸Ğ½Ñ„Ğ»ÑĞµĞ½ÑĞµÑ€Ğ¾Ğ² (Ğ¾Ğ´Ğ¸Ğ½ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚ = Ğ¾Ğ´Ğ½Ğ¾ ÑƒÑ‡Ğ°ÑÑ‚Ğ¸Ğµ)
- âœ… ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ñ€Ñ‹Ğ½Ğ¾Ñ‡Ğ½Ğ°Ñ Ğ¾Ñ†ĞµĞ½ĞºĞ° Ğ±ÑĞ´Ğ¶ĞµÑ‚Ğ°
- âœ… ĞœĞµÑ…Ğ°Ğ½Ğ¸Ğ·Ğ¼ Ğ¾Ğ²ĞµÑ€Ğ±ÑƒĞºĞ¸Ğ½Ğ³Ğ° Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸ĞµĞ¼
- âœ… ĞœĞµÑ…Ğ°Ğ½Ğ¸Ğ·Ğ¼ Ğ´Ğ¾Ğ±Ğ¾Ñ€Ğ° Ñ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ğ°Ğ¼Ğ¸
- âœ… Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ Ğ¾Ñ‚ĞºĞ»Ğ¸ĞºĞ¾Ğ² ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ĞµĞ»Ñ
- âœ… Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ Ğ¿Ğ¾Ğ·Ğ´Ğ½Ğ¸Ñ… Ğ¿Ñ€Ğ¸Ğ½ÑÑ‚Ğ¸Ğ¹
- âœ… Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹ Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ´Ğ»Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸ĞºĞ¸
- âœ… RLS-Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸ Ğ´Ğ»Ñ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸

### Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑÑ‚ĞµĞº

- **Backend Logic:** TypeScript service classes
- **Database:** PostgreSQL (Supabase)
- **Triggers:** PL/pgSQL functions
- **Real-time:** pg_notify Ğ´Ğ»Ñ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹
- **Security:** Row Level Security (RLS)

### Ğ¤Ğ°Ğ¹Ğ»Ñ‹ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

1. `src/modules/campaigns/services/automaticCampaignService.ts` - Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°
2. `supabase/migrations/create_collaboration_offers_table.sql` - Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° offers
3. `supabase/migrations/create_automatic_campaign_triggers.sql` - Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹
4. `src/core/supabase.ts` - ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ TABLES

### Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ

- `AUTOMATIC_CAMPAIGNS_DEDUPLICATION.md` - Ğ¿Ğ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ¾ Ğ¾ Ğ´ĞµĞ´ÑƒĞ¿Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸
- `AUTOMATIC_CAMPAIGNS_IMPLEMENTATION_SUMMARY.md` - ÑÑ‚Ğ° ÑĞ²Ğ¾Ğ´ĞºĞ°

---

## ğŸš€ Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾ Ğº Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ!

Ğ’ÑĞµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¸ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… ĞºĞ°Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¹ **Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ñ‹** Ğ¸ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ñ‹ Ğº production Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ.
